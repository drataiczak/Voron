Taken in whole or in part from https://github.com/jlas1/Klicky-Probe
