Taken in whole or in part from https://github.com/Frix-x/klippain
